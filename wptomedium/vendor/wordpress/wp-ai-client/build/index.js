(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Capability:()=>g,FileType:()=>r,FinishReason:()=>o,MediaOrientation:()=>n,MessagePartChannel:()=>p,MessagePartType:()=>d,MessageRole:()=>c,Modality:()=>l,OperationState:()=>a,ProviderType:()=>h,ToolType:()=>u});const s=window.wp.apiFetch;var i=e.n(s);const r={INLINE:"inline",REMOTE:"remote"},n={SQUARE:"square",LANDSCAPE:"landscape",PORTRAIT:"portrait"},o={STOP:"stop",LENGTH:"length",CONTENT_FILTER:"content_filter",TOOL_CALLS:"tool_calls",ERROR:"error"},a={STARTING:"starting",PROCESSING:"processing",SUCCEEDED:"succeeded",FAILED:"failed",CANCELED:"canceled"},u={FUNCTION_DECLARATIONS:"function_declarations",WEB_SEARCH:"web_search"},h={CLOUD:"cloud",SERVER:"server",CLIENT:"client"},d={TEXT:"text",FILE:"file",FUNCTION_CALL:"function_call",FUNCTION_RESPONSE:"function_response"},p={CONTENT:"content",THOUGHT:"thought"},l={TEXT:"text",DOCUMENT:"document",IMAGE:"image",AUDIO:"audio",VIDEO:"video"},c={USER:"user",MODEL:"model"},g={TEXT_GENERATION:"text_generation",IMAGE_GENERATION:"image_generation",TEXT_TO_SPEECH_CONVERSION:"text_to_speech_conversion",SPEECH_GENERATION:"speech_generation",MUSIC_GENERATION:"music_generation",VIDEO_GENERATION:"video_generation",EMBEDDING_GENERATION:"embedding_generation",CHAT_HISTORY:"chat_history"};class m{constructor(e){this.file=e}get fileType(){return this.file.fileType}get mimeType(){return this.file.mimeType}get url(){return this.file.url}get base64Data(){return this.file.base64Data}isInline(){return this.fileType===r.INLINE}isRemote(){return this.fileType===r.REMOTE}getDataUri(){if(this.base64Data)return`data:${this.mimeType};base64,${this.base64Data}`}isVideo(){return this.mimeType.startsWith("video/")}isImage(){return this.mimeType.startsWith("image/")}isAudio(){return this.mimeType.startsWith("audio/")}isText(){return this.mimeType.startsWith("text/")}isDocument(){return"application/pdf"===this.mimeType||this.mimeType.startsWith("application/msword")||this.mimeType.startsWith("application/vnd.openxmlformats-officedocument")||this.mimeType.startsWith("application/vnd.ms-")}isMimeType(e){return this.mimeType.startsWith(e+"/")||this.mimeType===e}}class T{constructor(e){if(!e.candidates||0===e.candidates.length)throw new Error("At least one candidate must be provided");this.result=e}get id(){return this.result.id}get candidates(){return this.result.candidates}get tokenUsage(){return this.result.tokenUsage}get providerMetadata(){return this.result.providerMetadata}get modelMetadata(){return this.result.modelMetadata}get additionalData(){return this.result.additionalData}getCandidateCount(){return this.result.candidates.length}hasMultipleCandidates(){return this.getCandidateCount()>1}toText(){const e=this.result.candidates[0].message;for(const t of e.parts)if(t.channel===p.CONTENT&&t.type===d.TEXT)return t.text;throw new Error("No text content found in first candidate")}toFile(){const e=this.result.candidates[0].message;for(const t of e.parts)if(t.channel===p.CONTENT&&t.type===d.FILE)return t.file;throw new Error("No file content found in first candidate")}toImageFile(){const e=this.toFile();if(!this.isImage(e))throw new Error(`File is not an image. MIME type: ${e.mimeType}`);return e}toAudioFile(){const e=this.toFile();if(!this.isAudio(e))throw new Error(`File is not an audio file. MIME type: ${e.mimeType}`);return e}toVideoFile(){const e=this.toFile();if(!this.isVideo(e))throw new Error(`File is not a video file. MIME type: ${e.mimeType}`);return e}toMessage(){return this.result.candidates[0].message}toTexts(){const e=[];for(const t of this.result.candidates){const s=t.message;for(const t of s.parts)if(t.channel===p.CONTENT&&t.type===d.TEXT){e.push(t.text);break}}return e}toFiles(){const e=[];for(const t of this.result.candidates){const s=t.message;for(const t of s.parts)if(t.channel===p.CONTENT&&t.type===d.FILE){e.push(t.file);break}}return e}toImageFiles(){return this.toFiles().filter(e=>this.isImage(e))}toAudioFiles(){return this.toFiles().filter(e=>this.isAudio(e))}toVideoFiles(){return this.toFiles().filter(e=>this.isVideo(e))}toMessages(){return this.result.candidates.map(e=>e.message)}isImage(e){return e.mimeType.startsWith("image/")}isAudio(e){return e.mimeType.startsWith("audio/")}isVideo(e){return e.mimeType.startsWith("video/")}}class E{messages=[];modelConfig={};modelPreferences=[];constructor(e){e&&(this.isMessagesList(e)?this.messages=e:this.messages.push(this.parseMessage(e,c.USER)))}withText(e){const t={channel:p.CONTENT,type:d.TEXT,text:e};return this.appendPartToMessages(t),this}withFile(e){const t={channel:p.CONTENT,type:d.FILE,file:e};return this.appendPartToMessages(t),this}withFunctionResponse(e){const t={channel:p.CONTENT,type:d.FUNCTION_RESPONSE,functionResponse:e};return this.appendPartToMessages(t),this}withMessageParts(...e){for(const t of e)this.appendPartToMessages(t);return this}withHistory(...e){return this.messages.push(...e),this}usingModel(e,t){return this.providerId=e,this.modelId=t,this}usingModelPreference(...e){return this.modelPreferences=e,this}usingModelConfig(e){return this.modelConfig={...this.modelConfig,...e},this}usingProvider(e){return this.providerId=e,this}usingSystemInstruction(e){return this.modelConfig.systemInstruction=e,this}usingMaxTokens(e){return this.modelConfig.maxTokens=e,this}usingTemperature(e){return this.modelConfig.temperature=e,this}usingTopP(e){return this.modelConfig.topP=e,this}usingTopK(e){return this.modelConfig.topK=e,this}usingStopSequences(...e){const t=this.modelConfig.stopSequences||[];return this.modelConfig.stopSequences=[...t,...e],this}usingCandidateCount(e){return this.modelConfig.candidateCount=e,this}usingFunctionDeclarations(...e){const t=this.modelConfig.functionDeclarations||[];return this.modelConfig.functionDeclarations=[...t,...e],this}usingPresencePenalty(e){return this.modelConfig.presencePenalty=e,this}usingFrequencyPenalty(e){return this.modelConfig.frequencyPenalty=e,this}usingWebSearch(e){return this.modelConfig.webSearch=e,this}usingRequestOptions(e){return this.requestOptions=e,this}usingTopLogprobs(e){return void 0!==e?(this.modelConfig.topLogprobs=e,this.modelConfig.logprobs=!0):this.modelConfig.logprobs=!0,this}asOutputMimeType(e){return this.modelConfig.outputMimeType=e,this}asOutputSchema(e){return this.modelConfig.outputSchema=e,this}asOutputModalities(...e){return this.includeOutputModalities(...e),this}asOutputFileType(e){return this.modelConfig.outputFileType=e,this}asJsonResponse(e){return this.asOutputMimeType("application/json"),e&&this.asOutputSchema(e),this}async isSupported(e){return(await i()({path:"/wp-ai/v1/is-supported",method:"POST",data:{messages:this.messages,modelConfig:this.modelConfig,providerId:this.providerId,modelId:this.modelId,modelPreferences:this.modelPreferences,capability:e,requestOptions:this.requestOptions}})).supported}async isSupportedForTextGeneration(){return this.isSupported(g.TEXT_GENERATION)}async isSupportedForImageGeneration(){return this.isSupported(g.IMAGE_GENERATION)}async isSupportedForTextToSpeechConversion(){return this.isSupported(g.TEXT_TO_SPEECH_CONVERSION)}async isSupportedForVideoGeneration(){return this.isSupported(g.VIDEO_GENERATION)}async isSupportedForSpeechGeneration(){return this.isSupported(g.SPEECH_GENERATION)}async isSupportedForMusicGeneration(){return this.isSupported(g.MUSIC_GENERATION)}async isSupportedForEmbeddingGeneration(){return this.isSupported(g.EMBEDDING_GENERATION)}async generateResult(e){const t=await i()({path:"/wp-ai/v1/generate",method:"POST",data:{messages:this.messages,modelConfig:this.modelConfig,providerId:this.providerId,modelId:this.modelId,modelPreferences:this.modelPreferences,capability:e,requestOptions:this.requestOptions}});return new T(t)}async generateTextResult(){return this.includeOutputModalities(l.TEXT),this.generateResult(g.TEXT_GENERATION)}async generateImageResult(){return this.includeOutputModalities(l.IMAGE),this.generateResult(g.IMAGE_GENERATION)}async generateSpeechResult(){return this.includeOutputModalities(l.AUDIO),this.generateResult(g.SPEECH_GENERATION)}async convertTextToSpeechResult(){return this.includeOutputModalities(l.AUDIO),this.generateResult(g.TEXT_TO_SPEECH_CONVERSION)}async generateText(){return(await this.generateTextResult()).toText()}async generateTexts(e){return e&&this.usingCandidateCount(e),(await this.generateTextResult()).toTexts()}async generateImage(){const e=await this.generateImageResult();return new m(e.toImageFile())}async generateImages(e){return e&&this.usingCandidateCount(e),(await this.generateImageResult()).toImageFiles().map(e=>new m(e))}async convertTextToSpeech(){const e=await this.convertTextToSpeechResult();return new m(e.toAudioFile())}async convertTextToSpeeches(e){return e&&this.usingCandidateCount(e),(await this.convertTextToSpeechResult()).toAudioFiles().map(e=>new m(e))}async generateSpeech(){const e=await this.generateSpeechResult();return new m(e.toAudioFile())}async generateSpeeches(e){return e&&this.usingCandidateCount(e),(await this.generateSpeechResult()).toAudioFiles().map(e=>new m(e))}appendPartToMessages(e){const t=this.messages[this.messages.length-1];t&&t.role===c.USER?t.parts.push(e):this.messages.push({role:c.USER,parts:[e]})}parseMessage(e,t){if(e.role&&e.parts)return e;if(e.type)return{role:t,parts:[e]};if("string"==typeof e){if(""===e.trim())throw new Error("Cannot create a message from an empty string.");return{role:t,parts:[{channel:p.CONTENT,type:d.TEXT,text:e}]}}if(Array.isArray(e)){if(0===e.length)throw new Error("Cannot create a message from an empty array.");const s=[];for(const t of e)"string"==typeof t?s.push({channel:p.CONTENT,type:d.TEXT,text:t}):s.push(t);return{role:t,parts:s}}throw new Error("Invalid input for message.")}isMessagesList(e){return!(!Array.isArray(e)||0===e.length)&&void 0!==e[0].role}includeOutputModalities(...e){const t=this.modelConfig.outputModalities||[],s=Array.from(new Set([...t,...e]));this.modelConfig.outputModalities=s}}const f={prompt:function(e){return new E(e)},enums:t};"undefined"!=typeof window&&"wp"in window&&"object"==typeof window.wp&&(window.wp.aiClient=f)})();